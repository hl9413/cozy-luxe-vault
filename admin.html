<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>å•†å®¶åå° - ä¸Šä¼ å•†å“å›¾ç‰‡</title>
</head>
<body>

  <h2>å•†å®¶åå°ï¼ˆæµ‹è¯•ä¸Šä¼ ï¼‰</h2>

  <input type="file" id="fileInput" />
  <br /><br />
  <button id="uploadBtn">ä¸Šä¼ å›¾ç‰‡</button>

  <script>
    const uploadBtn = document.getElementById("uploadBtn");
    const fileInput = document.getElementById("fileInput");

    uploadBtn.onclick = async () => {
      const file = fileInput.files[0];
      if (!file) {
        alert("è¯·å…ˆé€‰æ‹©å›¾ç‰‡");
        return;
      }

      try {
        // 1ï¸âƒ£ è¯·æ±‚åç«¯ï¼Œæ‹¿ä¸Šä¼ åœ°å€
        const res = await fetch("/api/upload-url");
        const data = await res.json();
        console.log("uploadUrl =", data.uploadUrl);

        console.log("åç«¯è¿”å›ï¼š", data);

        // 2ï¸âƒ£ ç”¨ PUT ä¸Šä¼ å›¾ç‰‡ï¼ˆæµ‹è¯•ï¼‰
        const uploadRes = await fetch(data.uploadUrl, {
          method: "PUT",
          body: file
        });

        if (!uploadRes.ok) {
          throw new Error("PUT ä¸Šä¼ å¤±è´¥");
        }

        alert("ğŸ‰ å›¾ç‰‡ PUT ä¸Šä¼ æµ‹è¯•æˆåŠŸï¼");
      } catch (err) {
        console.error(err);
        alert("âŒ ä¸Šä¼ å¤±è´¥ï¼š" + err.message);
      }
    };
  </script>

</body>
</html>
