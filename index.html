<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•†å“ä¸Šä¼ åå°ï¼ˆå«ä»·æ ¼ï¼‰</title>
    <!-- å¼•å…¥ AWS SDK -->
    <script src="https://cdn.bootcdn.net/ajax/libs/aws-sdk/2.1849.0/aws-sdk.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            padding: 20px;
            background-color: #f0f2f5;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        h1 { 
            text-align: center; 
            color: #1890ff; 
            margin-bottom: 30px;
            font-weight: 600;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }
        .input-field {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #d9d9d9;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border 0.3s;
        }
        .input-field:focus {
            border-color: #1890ff;
            outline: none;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
        }
        /* ä»·æ ¼è¾“å…¥æ¡†çš„ç‰¹æ®Šæ ·å¼ */
        .price-input {
            font-size: 18px;
            font-weight: bold;
            letter-spacing: 1px;
        }
        button {
            width: 100%;
            padding: 15px;
            margin-top: 10px;
            background-color: #1890ff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover { 
            background-color: #40a9ff; 
        }
        #status { 
            margin-top: 20px; 
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        .success { 
            background-color: #f6ffed; 
            color: #52c41a; 
            border: 1px solid #b7eb8f;
        }
        .error { 
            background-color: #fff1f0; 
            color: #f5222d; 
            border: 1px solid #ffa39e;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“¦ å•†å“å‘å¸ƒä¸­å¿ƒ</h1>

    <!-- 1. å•†å“æè¿° -->
    <div class="form-group">
        <label for="description">ğŸ“ å•†å“æ ‡é¢˜/æè¿°</label>
        <input type="text" id="description" class="input-field" placeholder="ä¾‹å¦‚ï¼šå¤å­£æ–°æ¬¾å®½æ¾çº¯æ£‰Tæ¤">
    </div>

    <!-- 2. å•†å“ä»·æ ¼ (æ–°å¢) -->
    <div class="form-group">
        <label for="price">ğŸ’° å•†å“ä»·æ ¼ (å…ƒ)</label>
        <input 
            type="number" 
            id="price" 
            class="input-field price-input" 
            placeholder="0.00" 
            step="0.01" 
            min="0.01"
            oninput="this.value = this.value.replace(/[^0-9.]/g, '')">
        <div style="margin-top: 6px; font-size: 12px; color: #999;">* è¯·åªè¾“å…¥æ•°å­—ï¼Œä¾‹å¦‚ï¼š99.99</div>
    </div>

    <!-- 3. å›¾ç‰‡ä¸Šä¼  -->
    <div class="form-group">
        <label>ğŸ–¼ï¸ ä¸Šä¼ å›¾ç‰‡ (æ”¯æŒå¤šé€‰)</label>
        <input type="file" id="imageInput" accept="image/*" multiple style="padding: 10px 0;">
        <div style="font-size: 12px; color: #999; margin-top: 6px;">* ç‚¹å‡»é€‰æ‹©æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°è¿™é‡Œ</div>
    </div>

    <!-- 4. æäº¤æŒ‰é’® -->
    <button onclick="submitProduct()">ğŸš€ ç«‹å³å‘å¸ƒ</button>

    <!-- 5. çŠ¶æ€æç¤º -->
    <div id="status"></div>
</div>

<script>
    // === é…ç½®åŒºåŸŸ (è¯·æ›¿æ¢ä¸ºä½ è‡ªå·±çš„ä¿¡æ¯) ===
    AWS.config.update({
        accessKeyId: '5b513140b083bdbc30cfaadceccfe476', // æ›¿æ¢ä¸ºä½ çš„ Key
        secretAccessKey: 'a35eb55adb554d485e3d0cf9fa0f759d0761f3573e46b23bf754af449a4984ae', // æ›¿æ¢ä¸ºä½ çš„ Secret
        endpoint: 'https://0286f816dbffbf01dbbe56cbf8d7a381.r2.cloudflarestorage.com',
        region: 'auto',// æ›¿æ¢ä¸ºä½ çš„ Endpoint
        s3ForcePathStyle: true
    });

    const s3 = new AWS.S3({
        params: { Bucket: 'my-product-images' } // æ›¿æ¢ä¸ºä½ çš„ Bucket åç§°
    });

    // === æäº¤é€»è¾‘ ===
    async function submitProduct() {
        const description = document.getElementById('description').value;
        const price = document.getElementById('price').value;
        const files = document.getElementById('imageInput').files;
        const statusDiv = document.getElementById('status');

        // æ ¡éªŒæè¿°
        if (!description.trim()) {
            showStatus('âš ï¸ è¯·å¡«å†™å•†å“æè¿°ï¼', 'error');
            return;
        }

        // æ ¡éªŒä»·æ ¼
        if (!price || parseFloat(price) <= 0) {
            showStatus('âš ï¸ è¯·è¾“å…¥æ­£ç¡®çš„ä»·æ ¼ï¼', 'error');
            return;
        }

        // æ ¡éªŒå›¾ç‰‡
        if (files.length === 0) {
            showStatus('âš ï¸ è¯·è‡³å°‘é€‰æ‹©ä¸€å¼ å›¾ç‰‡ï¼', 'error');
            return;
        }

        // æ˜¾ç¤ºåŠ è½½ä¸­
        showStatus(`ğŸ“¤ æ­£åœ¨ä¸Šä¼ ï¼š${files.length} å¼ å›¾ç‰‡...`, '');
        
        try {
            // ä¸Šä¼ æ‰€æœ‰å›¾ç‰‡
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const params = {
                    Key: `products/${Date.now()}_${file.name}`,
                    Body: file,
                    ContentType: file.type
                };
                await s3.upload(params).promise();
            }

            // ä¸Šä¼ æˆåŠŸ
            showStatus(`âœ… å•†å“ã€${description}ã€‘<br>ğŸ’° ä»·æ ¼ï¼š${price} å…ƒ<br>ğŸ–¼ï¸ å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼`, 'success');
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('description').value = '';
            document.getElementById('price').value = '';
            document.getElementById('imageInput').value = '';

        } catch (error) {
            console.error('ä¸Šä¼ å¤±è´¥:', error);
            showStatus('âŒ ä¸Šä¼ å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–é…ç½®ï¼', 'error');
        }
    }

    // çŠ¶æ€æ˜¾ç¤ºå‡½æ•°
    function showStatus(msg, type) {
        const statusDiv = document.getElementById('status');
        statusDiv.innerHTML = msg;
        statusDiv.style.display = 'block';
        statusDiv.className = type;
    }
</script>

</body>
</html>