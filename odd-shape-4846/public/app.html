<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cozy Shop</title>
  <meta http-equiv="Cache-Control" content="no-store" />
<script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <h1>Cozy Shop</h1>

<div id="product-list">Loading products...</div>

<script>
async function loadProducts() {
  const res = await fetch('https://odd-shape-4846.1914653652.workers.devhttps://odd-shape-4846.1914653652.workers.dev/api/public/products')
  const products = await res.json()

  const el = document.getElementById('product-list')
  el.innerHTML = ''

  products.forEach(p => {
    const div = document.createElement('div')
    div.style.padding = '12px'
    div.style.borderBottom = '1px solid #eee'
    div.innerHTML = `
      <strong>${p.name}</strong><br/>
      $${p.price}
    `
    el.appendChild(div)
  })
}

loadProducts()
</script>


  <script>
  const tg = window.Telegram?.WebApp
  if (tg) {
    tg.ready()
    tg.expand()
  }

  const productListEl = document.getElementById('productList')

  fetch('https://odd-shape-4846.1914653652.workers.devhttps://odd-shape-4846.1914653652.workers.dev/api/public/products')
    .then(res => res.json())
    .then(products => {
      productListEl.innerHTML = ''

      products.forEach(p => {
        const card = document.createElement('div')
        card.className = 'product-card'
        card.innerHTML = `
          <p><strong>${p.name}</strong></p>
          <p>$${p.price}</p>
          <a href="/product.html?id=${p.id}">View Details</a>
`

          <a href="/product.html?id=${p.id}">View Details</a>
          <button onclick="addToCart(${p.id}, '${p.name}', ${p.price})">
            Add to Cart
          </button>
        `
        productListEl.appendChild(card)
      })
    })

  function addToCart(id, name, price) {
    let cart = JSON.parse(localStorage.getItem('cart') || '[]')
    const idx = cart.findIndex(i => i.id === id)
    if (idx > -1) {
      cart[idx].quantity += 1
    } else {
      cart.push({ id, name, price, quantity: 1 })
    }
    localStorage.setItem('cart', JSON.stringify(cart))
    alert('Added to cart')
  }
</script>

</body>
</html>


